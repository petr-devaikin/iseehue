{% extends "layout.html" %}

{% block style %}
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/chord.css') }}">
{% endblock %}

{% block script %}
    requirejs(['drawing/chord'], function(drawingChord) {
        var answers = {{ answers | safe }};
        var my_answers = {{ my_answers | safe }};
        drawingChord(answers, my_answers);
    });
{% endblock %}

{% block body %}
    <div class="container">
        <h1>How People Perceive Hues</h1>

        <div id="chordContainer">
            <svg id="results">
                <g id="chords">
                    <g id="all"></g>
                    <g id="mine"></g>
                </g>
                <g id="palette"></g>
            </svg>

            {% if user %}
                {% if tested %}
                    <div id="buttons">
                        <div class="toggle" id="allButton">
                            <span>All people</span>
                        </div>
                        <div class="toggle active" id="mineButton">
                            <span>Your results</span>
                        </div>
                        <p>
                            {% if mutual > 0 %}
                                {{ mutual }}% of people percive
                            {% else %}
                                Nobody percives
                            {% endif %}
                            hues like you
                        </p>
                    </div>
                {% else %}
                    <div id="doTestNotification">
                        You have not passed the test yet.
                        <a href="{{ url_for('test') }}" class="button" id="startButton">Start it</a>
                    </div>
                {% endif %}
            {% endif %}
        </div>

        {% if user %}
            <p>
                You are logged in as <em>{{ user.name }}</em>.
                <a href="{{ url_for('logout') }}" id="logout" class="button">Log out</a>
            </p>
        {% else %}
            <p>
                <a href="{{ url_for('login') }}" id="login" class="button">Log in via Facebook</a> to know your results.
            </p>
        {% endif %}
    </div>
{% endblock %}

{% block disclaimer %}
    | {{ polled_count }} people have been polled
{% endblock %}